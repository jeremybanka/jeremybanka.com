const W_GUTTER = 10;

function buildStrip() {
  const A_strips = Array.from(document.getElementsByClassName("imagestrip"));
  A_strips.forEach(E_strip => {
    const A_images = Array.from(E_strip.children);
    const RT_constrainedImage = A_images.reduce(
      (memo, E_image) => memo + E_image.naturalWidth / E_image.naturalHeight,
      0
    );

    const WT_gutters = W_GUTTER * (A_images.length + 1);
    console.log(WT_gutters);
    A_images.forEach(E_image => {
      const R_landscape = E_image.naturalWidth / E_image.naturalHeight;
      const RP_image_constrainedImage = R_landscape / RT_constrainedImage;
      E_image.style.setProperty("--RP-I-CI", RP_image_constrainedImage);
      E_image.style.setProperty("--WT-G", WT_gutters + "px");
    });
  });
}

const bc = Array.from(document.body.children);

bc.forEach(child => child.style.setProperty("visibility", "hidden"));

const protoWait = document.createElement("img");
protoWait.setAttribute(
  "src",
  "data:image/gif;base64,R0lGODlhkAGMANUgAPn4+f7+/svK0Pf4+Z6cp/Hz9OXl6Pv8/KWjrfL09NjX3LGwufn6+vT19uzr7fz9/b69xfb39/Ly8/39/fP09aups/f4+MXEyvr7+9/e4vX297i3v9LR1vj5+vDy85iWov///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MUIxRDJFNjVENjVEMTFFOEJCQThGNTgyQ0Y4QUZFNEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MUIxRDJFNjZENjVEMTFFOEJCQThGNTgyQ0Y4QUZFNEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxQjFEMkU2M0Q2NUQxMUU4QkJBOEY1ODJDRjhBRkU0QSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxQjFEMkU2NEQ2NUQxMUU4QkJBOEY1ODJDRjhBRkU0QSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAUyACAALAAAAACQAYwAAAb/QJBwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum8/otHrNbrvf8Lh8Tq/b7/i8fs/v+/+AgYKDhIWGh4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanqKmqq6ytrq+wsbKztLW2t7i5uru8vb6/wMHCw8TFxsfIycrLzM3Oz9DR0tPU1dbX2Nna29zd3t/g4eLj5OXm5+jp6uvsTxIG8AYAogDx8vT2Eu1HDhwQCx8CChSIYMGFDPoqSVBwYQGBgQMJGFSQkJKEDA0fQhS4AAIHB+syQNC4saTAChwqNnJwAYHJlx8QXAD5SMKFCjBNEoCQoRwA/wEucwpdoGARAAVBhcJEoGCeIgUAlS4V4NTbT5JSczI9dDWrUgJUDyH1KhRsVW0csJLNWcEAoQxJ12rtOcgATrllOWhzcBev1Atn+QDY4DfrhsB7AFwoLLUCzWoK1DKG6diPAcmTdbrtwzfz16LUIHjOSgC0Hg6js+rdEzm1UgjSAER1rdT0HdG0X+tRkFvpAsTJAPTtndM2HdzEc8K+wzs5W+DGhDuvbQf59JfL6TS//rJCM+vcTRp/IyB8TgHazcPMjqy8+pcEHr/J8B4mXTgOMNf/gB6ZAb8LCGCASg5gNJxXCECHhgT6CVWBgCq9I8CBpKnEBgBxeVXBQfJJOP/bWpsVg+FaCHCg4BAOjLTWBXB8KBVYFh4hgQANvrQAHIuRRcAFMRoBAAcZKpWgMTmSNt4SioHoBmpemQVFV16txsZ/ZAEWRWtesUgMlYadqIQBQS7VBgA1blRBj01IQCFMBHgpRpgvISDfk4R5NecvLuYkJRWyeXVkGeAph0Wg67GxnW9uLsGkVDcKwyV1WRBqEgJrSOAVe1ZIahKaY8BZEqZVHCpUiHhm9ScVeb50ahhFCgVqpllpiYaoMG3ABa02BmPpX12MqJR3aJDJqBepltRmGp5CVEGiUGi6Eae3tErZFw5kdacYuBrL7JNlCrSqF9VKdS0Wa5Ykay/JDkT/KhfuCXUuGXUK9W2oUtl6hrQv9efFo2L6Eq6rYQgrFKVmANDYm1Jti0W6AR0LhrMDjWtLuzlBiwXFMEncBX2QgpHtRveN8e95YuwqlL67FAtRo2GYrKcZ+JZEMMLumrFoTgpPofJALO8i1bxYxFtoGeVC9O4XMW/UsxgQB2QvtlL1MjJMOU/xMc9mSLXuF/y+ZEbRAwF9hcFKWRxL1yUBK3LUZLgMU9ZllyGV2VmALdDWE+smt1JVS4G20mbsfDcZZAtlRtP88YKxSSiLIXhAeG+sNxmIhwzG3yubsXhJjd+yOciBKxU5u0p1DsbnEJneBeZYl8ExybskDdHoXSBO/7sWqA+kuhe5C7T7FqwLdPTlpfMi9Eu3b9E75GQsn3gZzv+uRfABSQ988bs4n7wWj3+w/RXRa469GNR/8PQY5VsPi/N7Oi46GTfnK75Q7XPtm83j5xJ+GQx/oPH09ytD975nhalNan6w08XVOAI3w5GhfDPr1PvIwDYydE9srigfAcoAwTIUrmJtq+AYuuW9MpCQgK34YMbIILvWkYGEGKTXwEJXs7XxDV1KGV4X+qe+LBzPJOcDww9LEsQwOC+CYGghQXyBuA2STyqWC0P8XkK3KrjtJfUDw+tygsIpkPBVt1igt9x3wzIY0CQ61IISBfK/LagwV2EQY0Bi6Io3Hv+QeEopIs1yQoAqSuGKdzTDEEvSxSf4Sih9Y8UgN9JDKdhtjPeqlxB5dQY5fkBtXXCe+YBhSf/x7kWJpMIZxeOFTraRC3ZkHLhMFQwSxiSUR9iioNLwyIad8gn5GVYaEBeQKFrhkHwUhiYvCUsi5HJuauhkH7VwzI6dAZA6uSUTpCOVRs5CYL8qJggukxUwkqF/tsRCM2e4hkVuJD5YoOZXtLmKYcZEmkeYIgjXIEs++vIJGXBlL9kATSwWEJzVIwYw8+cOc5rLDd0biJWikCSvLC0Na4TIBvxIBHe+shjlg8hWnAClrAypDf2ET1ia0NEXUdQL2HzRSJswFrIUshb/vNToTJIAAJHg5aVdkGdZeKIEkehzIFlMQ0Y3whMFsQSgCkWGOtcikQsI4KkC2EAtX5LGNCTUJB2BqgD+URg9riGi3dmAVhtSmGUlY5z7CchDxzTV6ZhVDld1DjqVMdTkvFUOaK3PXOWw1LTiNBed7M1d55BX8+x1DgN9Dx19EVjXDJYOhb3OYemgprQu9hfcVM9j6+AApHpGTnroq2T/6q+2ZgYC7ByDaJPzG8HENDOVocZgJHvZNljUL9aEQ1qug1pswIW1J42DXewKTzlIIK4kuuc0SvpZ5fZht64hQFD98NvornQbM/rpUmpbB+b6BQHXLURLJ+OkcBzFtEQlqi0eFGDQnGyAu3mwqV8q0JRzSIADG3AlAooqiaNAAJz7rW8kavrfF20gJfuQUFQXwGCDCIAD98iEgv/RYAg8dUCaqAcHttrgBYgVQvsIsYhHTOISm/jEKE6xilfM4ha7+MUwjrGMZ0zjGtv4xjjOsY53zOMe+/jHQA6ykIdM5CIb+chITrKSl8zkJjv5yVCOspSnTOUqW/nKWM6ylrfM5S57+ctgDrOYnRwEACH5BAUyACAALD4AJQBEAEQAAAb/QJBwSCwaj8PJYXkIIJ/QqNT46EQanqxWm2hYMJOpeFzERArbtFpL6YTJ8GNgkFjb7w1GfD9H3/92CXp7Yh1+gIhrFAeEUA8UiZF3Fk6NRQyHkppbFA+WQxGbomoFg4QBWKOqW6ZwAZCrsVmtYq+ytx60UqG4t7pPA724BZ5SB6sNAwdvQg8YFrCiCZVPAXWbCR3UTw9nohZRFpulruKbjEjHmhrbZAfXkQlPqZEdn6iav+qRv3u8ifKM0EPUj9BAQLQmSAL3qYi1SBSKmEMUsSEVScWEwAOEzmKRYIkYgngQKYJHOZnuBAQBEhGzk0RaAip20E4DmEcUJrIHgh/O/yMaEpkkmajdTxAMEt3c96fiUSJEEbEU+tRIpDmJBlQtUnPNAZl3MGwl0lXNgYl/Oo79lzYoIrVbwdr5mghu1bJp6CLiORYE3i16AWntC2LjnQdJEd0kHAkE0zsFCD8OBCJApIxV0eLRGLKvYTuD2UIeO9mOWKQ+714VYhlg1dJrNBBxi2jwz2gIiSROhNmjXDsF2qVUadQSBkkmP0qiUHzPg+F3XrKGbod5wwPU1yQ38ltlbzgdNkkf8lCTbTITaEcSeQT2H0Fj+mBrDmpUAgvfyZtRZdeILVUFeDHAgANogNs3YjwnjCyLieHeghTRh8RuEC4n4RMUVgiIdYRgp0jhhhdK8ciHdkQQ4hQBqEciOTBh8NmCDYxnkXwQJnBaVRMMkB02Bf0UAAMHbhJBf4RN0IEGO26RQAQYnFjkVwU2IKWAHTRxUhAAIfkEBTIAIAAspgAlAEQARAAABv9AkHBILBqPw8BheQggn9Co1DhhWBoFj3arLTQsjMl0TC4+LAmuer1NWB7lODLASLPv9wTDKY8HBll4gncFA3x9Uhh2g4xsCRiIUAEajZV4GoeRQweBlp5qBQeaQx2fpmwdoxGnrGoRkautslqvcrGzs7VkA7i9HgNkGL6+kFITnZ8UAwdiQxMHAxSsBc1QDaaF1U8TgKYNUaWehZlSf8iNqXPngxTaZRPSlgXkQ7eNurCe+M76o/We7kBYsLRPlSULRQKsu/PNX5FrjeYRYVBJokMiCisxIEKp0caLRSg20pCkEgWQRxYN4iPMI0ojIhkVG8gowcuUjRCCiDdI503/IjQHNawk6ieRA5VATEhqtEilZ40aNh0CcdCBloMKGrWHBwMvRsCmDvk6aABZQWHFgjiLx2yjtGLZ3nELVq0QuWwGhCtrdy06pIykiq0qaEkjm3ZV4mnyVO3SRkIWrvk4NaYgxB0HkRSbWdDmvYMConzMKN2DSj5/Bh0ER4hiQqIdkh6EWMhqz0Y7C0p9WuNNy6yL8BxUoPXFB5LXCBYCXBC148kn46xoPBJyS7WLYI1YDBGG6Gu6GyGck16524GhzK5oaIy5T8+hgJYXQbwRDBHA30kXhfynBhGYZVYE/nmyWTnDDXMKBeYhcZ2CpxQXx4MQylMdGRRWSNyFZTzwRpqGaiTAoR8JgrhFAw3KgZeGcDl0QIkKUjCiQx3ohw1/Rr3XSwLt9cWAbp9oQFlfSTAQwYeORLAHkVE8M2ADUAJoFjMgBQEAIfkEBTIAIAAsDgElAEQARAAABv9AkHBILBqPw8BheZggn9Co1DjBWBoFj3a7bUQ6j6l4XJxYKNy0eluIYMjwJ6OxrtsTg0B8z0jY/3YFeXtiB2iAiHUFHYRQARaJkXYUYY1FD4eSmmkFDJZDDFmbo2kRnwykqWkNenyqr1sUrWSosLYUcLW2tqZiD6K7tgNTAX6kFBYYlUITBwN0qQdSkJsFFk5RAR3GmgmzRwejFt9ToZsWUNyJCctwARqb7US6iayfHZoNSOqAvZ8g9BBJKxLwj4Z/8yTpK8JvErl/ESRhE/JAkjyEIDIBQjeEGqJhGIuEW0ek4ZoCD0NGTFSpYiKQIctEAokvUcqY0AAtXAnoYMz/IwXrCNFox9NPIwEiOVF69AjROgeSJmp6hOefASN1UjUy4GXWPwu3DsHgNRFHsUK+2sH6Eu0QtXXYIvLpFu4auVrdgqgJaIBLQAn0guj6EUQkwTn/eAL2ZyBaxnakJbZzdutfQHoIA3br8U9gEGQTOaYKuU4vqYjCNg26xigIeKKpFos0i7UaXE019ySCuvDPy4BcC7EK6E3I2YkKUJFU4CKhAE/XHoGd3Lm76IpSTtjEqNEDk9KRdE6kYSIZ3etugghQGpAg9Ub6jBoNLpUb9Q8sgN84ZfwmChoMIOAAV7wiixiTBUNKc2NAp+Ar9EmB3IObCDfGBNhRWIeFZDioSKF7EbpD3IdcUIJRB+1pGAF8cUyQ4IMJGHcUBvup8h5a8u1yo2AYjKgJBQywKFuPNXJRgAYdmCcYEkp0MEAEDUTZQIBYKWlJEAAh+QQFMgAgACw+ACUARABEAAAG/0CQcEgsGo9DiWFpACCf0KjU6OBAFp+sVotYXDKSqXhczEAI27RaW+GEyfAjQIBY2+8LRXw/R9//dgh6e2IcfoCIaxUGhFAOFYmRdxdOjUUKh5KaWxUOlkMQm6JqBIOEAFijqlumcACQq7FZrWKvsrcftFKhuLe6TwK9uASeUgarCwIGb0IOGRewogiVTwB1mwgc1E8OZ6IXURebpa7im4xIx5ob22QG15EIT6mRHJ+omr/qkb97vInyjNBD1I/QQEC0JEgC96mItUgViphDFLEhFUnFhMADhM5ikWCJGIJwEAmCRzmZ7gQEARIRs5NEWgIqdtDOAphHFCayB4Ifzv8jGxKZJJmo3U8QChLd3Pen4lEiRBGxFPrUSKQ5iQRULVJzjQGZdzJsJdJVjYGJfzqO/Zc2KCK1W8Ha+ZoIbtWyaegi4jkWBN4tegFp7Qti4x0HSRHdJBwJBNM7BAg/DgQCQKSMVdHi0Riyr2E7g9lCHjvZjlikPu9eFWIZYNXSazYQcYto8M9oCIkkToTZo1w7BNqlVGnUUgZJJj9KqlB8j4Phd16yhm6HeUMD1NckN/JbZW84HDZJH/JQk20yEmhHEnkE9h9BY/pgaw5qFIIL38mbUWXXiC1VBHghwIACbIDbN2I8J4wsi4nh3oIU0YfEbhAuJ+ETFFYIiHWEYKdI4YYXSvHIh3ZAEOIUAKhHIjkwZfDZgguMZ5F8ECJwWlUSCJAdNgX9BIACB24CQX+EScDBBjtugQAEGZxY5FcFLiClgBw0cVIQACH5BAUyACAALKYAJQBEAEQAAAb/QJBwSCwaj0OAYWkAIJ/QqNQoUVwWhI92qyUsLgrJdEwuOi4Irnq9RVwc5TgSoEiz73eEwimPAwRZeIJ3BAJ8fVIZdoOMbAgZiFAAG42VeBuHkUMGgZaeagQGmkMcn6ZsHKMQp6xqEJGrrbJar3Kxs7O1ZAK4vR8CZBm+vpBSEp2fFQIGYkMSBgIVrATNUAumhdVPEoCmC1GlnoWZUn/Ijalz54MV2mUS0pYE5EO3jbqwnvjO+qP1nu5AXLC0T5WlC0UArLvzzV+Ra43mEVFQSaJDIgorKSBCqdHGi0UoNtqQpFIFkEcWDeIjzCNKIyIZFRvICMHLlI0Qgog3SOdN/yI0BzWsJOonEQOVQEhIarRIpWeNGjYdAnGQgZaDChq1hycDL0bApg75OkgAWUFhxYI4i8dso7Ri2d5xC1atELlsBIQra3ctOqSMpIqtKmhJI5t2VeJp8lTt0kZCFq75ODWmIMQdB5EUm1nQ5r2DAqJ8zCidg0o+fwYdBEeIYkKiHZIehFjIas9GOwtKfVrjTcusi/AcRKD1RQeS1wgWAlwQtePJJ+OsaDwScku1i2CNWAxRhuhruhshnJNeuduBocyuaGiMuU/PoYCWB0G8kQwQwN9JF4X8pwUQmGUWBP55slk5ww1zSgXmIXGdgqcUF8eDEMpTHRkUVkjchWU48EaahmogwKEfCYK4xQINyoGXhnA5ZECJClYwokMc6IcNf0a91wsC7fWlgG6fbEBZX0koAMGHjkCwB5FRPDPgAlACaBYzIAUBADs="
);

document.body.insertBefore(protoWait, bc[0]);

window.onload = function() {
  bc.forEach(child => child.style.setProperty("visibility", "visible"));
  protoWait.setAttribute("style", "display: none");
  buildStrip();
};
